From: Wolfgang Rosenauer <wr@rosenauer.org>
Subject: Do not build nkgnomevfs in xul app builds
References:
https://bugzilla.mozilla.org/show_bug.cgi?id=512671

diff --git a/configure.in b/configure.in
--- a/configure.in
+++ b/configure.in
@@ -5744,6 +5744,13 @@ if test -z "$MOZ_ENABLE_GNOMEVFS" && tes
     MOZ_EXTENSIONS=`echo $MOZ_EXTENSIONS | sed -e 's|gnomevfs||'`
 fi
 
+if test ! -z "$LIBXUL_SDK_DIR" && test `echo "$MOZ_EXTENSIONS" | grep -c gnomevfs` -ne 0; then
+    if test -n "$MOZ_X11"; then
+        AC_MSG_WARN([nkgnomevfs is already part of xulrunner. Removing gnomevfs from MOZ_EXTENSIONS.])
+    fi
+    MOZ_EXTENSIONS=`echo $MOZ_EXTENSIONS | sed -e 's|gnomevfs||'`
+fi
+
 if test -z "$MOZ_JSDEBUGGER" && test `echo "$MOZ_EXTENSIONS" | grep -c venkman` -ne 0; then
     AC_MSG_WARN([Cannot build venkman without JavaScript debug library. Removing venkman from MOZ_EXTENSIONS.])
     MOZ_EXTENSIONS=`echo $MOZ_EXTENSIONS | sed -e 's|venkman||'`
